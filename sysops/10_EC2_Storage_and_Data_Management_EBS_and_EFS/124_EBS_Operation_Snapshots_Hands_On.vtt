WEBVTT

1
00:00:00.030 --> 00:00:01.050
<v Instructor>Okay, so let's have a look</v>

2
00:00:01.050 --> 00:00:02.700
at EBS snapshots in detail.

3
00:00:02.700 --> 00:00:05.100
So we have a volume of two gigabytes

4
00:00:05.100 --> 00:00:08.220
and I can do Action and then Create snapshot.

5
00:00:08.220 --> 00:00:09.660
And this will go ahead and create a snapshot

6
00:00:09.660 --> 00:00:11.250
directly from my volume.

7
00:00:11.250 --> 00:00:14.670
And as you can see, if my main volume is not encrypted,

8
00:00:14.670 --> 00:00:17.880
then my snapshots will not be encrypted as well.

9
00:00:17.880 --> 00:00:19.560
So let's create the snapshots.

10
00:00:19.560 --> 00:00:21.720
And now if you go to the Snapshots page,

11
00:00:21.720 --> 00:00:24.030
we can see the snapshot being created.

12
00:00:24.030 --> 00:00:25.200
So when you look at a snapshot,

13
00:00:25.200 --> 00:00:26.970
you have multiple things you can look at,

14
00:00:26.970 --> 00:00:28.440
but the first thing you can look at is the fact

15
00:00:28.440 --> 00:00:29.580
that if you do action,

16
00:00:29.580 --> 00:00:31.730
we can create a volume back from the snapshot.

17
00:00:31.730 --> 00:00:35.340
So we can create another gp2 gb2 volume of two gigabits

18
00:00:35.340 --> 00:00:36.480
and we can actual bytes

19
00:00:36.480 --> 00:00:39.120
and we can change the availability zone if you wanted to.

20
00:00:39.120 --> 00:00:42.000
So my main volume was in eu-west-1a.

21
00:00:42.000 --> 00:00:44.190
But thanks to the Restore Snapchat option,

22
00:00:44.190 --> 00:00:47.760
I can move my volume to eu-west-1b.

23
00:00:47.760 --> 00:00:50.910
On top of it, we can enable encryption for this volume

24
00:00:50.910 --> 00:00:53.460
if you wanted to encrypt our EBS volume,

25
00:00:53.460 --> 00:00:55.440
the new one with a KMS key

26
00:00:55.440 --> 00:00:57.630
but I'll leave it unchecked for now.

27
00:00:57.630 --> 00:00:59.310
So let's create this volume.

28
00:00:59.310 --> 00:01:01.920
And now if we go back to our volumes page,

29
00:01:01.920 --> 00:01:02.910
we have two volumes.

30
00:01:02.910 --> 00:01:05.370
One of them was created from a snapshot.

31
00:01:05.370 --> 00:01:06.690
Now if you look at a snapshot space as well,

32
00:01:06.690 --> 00:01:09.210
we can copy the snapshots.

33
00:01:09.210 --> 00:01:10.710
And when you copy a snapshot,

34
00:01:10.710 --> 00:01:14.220
you can copy it into the same region or a different region

35
00:01:14.220 --> 00:01:16.050
for disaster recovery purposes.

36
00:01:16.050 --> 00:01:17.790
And on top of it, when we copy the snapshots,

37
00:01:17.790 --> 00:01:21.240
we can encrypt it with a KMS key if we wanted to.

38
00:01:21.240 --> 00:01:23.640
And then any volumes created from the snapshots

39
00:01:23.640 --> 00:01:26.400
would of course be encrypted as well.

40
00:01:26.400 --> 00:01:28.050
Okay, so this is a good option.

41
00:01:28.050 --> 00:01:30.240
Next, we can see the other things.

42
00:01:30.240 --> 00:01:33.300
So let's look at something called the fast snapshot restore.

43
00:01:33.300 --> 00:01:36.123
So we can Manage fast snapshot restore.

44
00:01:37.020 --> 00:01:40.830
And this is a setting you enable per snapshots

45
00:01:40.830 --> 00:01:43.500
and you have to say whether or not you want it to be

46
00:01:43.500 --> 00:01:45.900
enabled in the specific AZs.

47
00:01:45.900 --> 00:01:48.540
And when you enable fast snapshot restore,

48
00:01:48.540 --> 00:01:50.760
you're going to pay a lot of money.

49
00:01:50.760 --> 00:01:52.620
Okay, so I don't suggest you click Enable

50
00:01:52.620 --> 00:01:54.960
because it says it gives you a little warning.

51
00:01:54.960 --> 00:01:59.550
It says it costs you per hour $0.75.

52
00:01:59.550 --> 00:02:03.030
So the idea is that when you want to restore a huge volume,

53
00:02:03.030 --> 00:02:06.480
then instead of mounting it and then reading all the blocks,

54
00:02:06.480 --> 00:02:08.430
you can enable fast snapshot restore.

55
00:02:08.430 --> 00:02:11.130
AWS will warm up the volume for you

56
00:02:11.130 --> 00:02:14.340
then you mount the volume and then you're good to go.

57
00:02:14.340 --> 00:02:16.500
But here, we don't need to enable it of course

58
00:02:16.500 --> 00:02:17.790
because it makes no sense.

59
00:02:17.790 --> 00:02:20.640
We have a two gigabytes volume.

60
00:02:20.640 --> 00:02:22.410
Next, we can look at storage tiers.

61
00:02:22.410 --> 00:02:24.180
So if you look at storage tiers right here,

62
00:02:24.180 --> 00:02:27.420
as you can see, my storage tier is currently standard.

63
00:02:27.420 --> 00:02:29.760
So that means that the storage tier is standard,

64
00:02:29.760 --> 00:02:32.040
but I can actually move the storage tier

65
00:02:32.040 --> 00:02:34.830
so we can archive the snapshots.

66
00:02:34.830 --> 00:02:36.180
And when you archive a snapshot,

67
00:02:36.180 --> 00:02:38.610
it's going to be in the archived tier

68
00:02:38.610 --> 00:02:40.620
which is costing you less money, okay?

69
00:02:40.620 --> 00:02:43.508
But if you do so, then it's going to take

70
00:02:43.508 --> 00:02:46.200
a little bit of time to restore from the snapshot.

71
00:02:46.200 --> 00:02:47.370
So you save on costs,

72
00:02:47.370 --> 00:02:48.810
but then if you wanna restore from snapshot,

73
00:02:48.810 --> 00:02:50.400
it will take longer.

74
00:02:50.400 --> 00:02:52.080
So you could go ahead and archive the snapshot

75
00:02:52.080 --> 00:02:54.210
and use change the actual storage tier.

76
00:02:54.210 --> 00:02:55.350
So let's do it right now.

77
00:02:55.350 --> 00:02:57.630
We do archive snapshots.

78
00:02:57.630 --> 00:03:01.200
And as you can see, the snapshot is being archived.

79
00:03:01.200 --> 00:03:04.500
And if I go back here, so it took a little bit of time

80
00:03:04.500 --> 00:03:07.710
but now my snapshot is in the archive storage.

81
00:03:07.710 --> 00:03:10.620
And so I'm going just go ahead

82
00:03:10.620 --> 00:03:12.720
and recreate a snapshot real quick.

83
00:03:12.720 --> 00:03:17.160
So I have a snapshot in the normal tier as well.

84
00:03:17.160 --> 00:03:18.840
Okay, so we have two snapshots now.

85
00:03:18.840 --> 00:03:20.730
One is standard, one archive.

86
00:03:20.730 --> 00:03:22.110
The other thing I want you to look at

87
00:03:22.110 --> 00:03:24.330
is the Lifecycle Manager.

88
00:03:24.330 --> 00:03:26.130
So Lifecycle Manager allows you to create

89
00:03:26.130 --> 00:03:28.350
an EBS snapshot policy

90
00:03:28.350 --> 00:03:30.240
and we can say what's going to happen.

91
00:03:30.240 --> 00:03:33.780
So we can target either volumes or instances.

92
00:03:33.780 --> 00:03:35.070
And then we need to enter tax.

93
00:03:35.070 --> 00:03:37.740
For example, we need to enter environment.

94
00:03:37.740 --> 00:03:39.510
And then the value would be Prod

95
00:03:39.510 --> 00:03:43.080
to only do snapshots of our prod volumes.

96
00:03:43.080 --> 00:03:45.390
So if we do so, we have to go back

97
00:03:45.390 --> 00:03:48.960
into the EC2 volumes page

98
00:03:48.960 --> 00:03:50.880
and go, for example, to this volume

99
00:03:50.880 --> 00:03:52.710
and say that the tag of this volume

100
00:03:52.710 --> 00:03:54.750
we're going to manage it, add it,

101
00:03:54.750 --> 00:03:55.830
and say well for this one,

102
00:03:55.830 --> 00:04:00.120
the environment is prod and save it.

103
00:04:00.120 --> 00:04:02.250
And so now thanks to this tag policy,

104
00:04:02.250 --> 00:04:05.170
only the volumes that have been marked with these tags

105
00:04:06.711 --> 00:04:08.700
are going to be archived.

106
00:04:08.700 --> 00:04:12.210
So we have this target resources, okay?

107
00:04:12.210 --> 00:04:14.523
And then we can say Demo Policy,

108
00:04:15.900 --> 00:04:18.390
an IAM role that will perform these snapshots.

109
00:04:18.390 --> 00:04:19.920
So we'll use the default role

110
00:04:19.920 --> 00:04:22.440
and it will be created if it doesn't exist.

111
00:04:22.440 --> 00:04:24.360
And then whether or not you want to enable the policy.

112
00:04:24.360 --> 00:04:26.370
So enable or not enabled.

113
00:04:26.370 --> 00:04:27.930
So we can enable it.

114
00:04:27.930 --> 00:04:29.880
And then we have to add schedule.

115
00:04:29.880 --> 00:04:31.860
So actually just to save on cost,

116
00:04:31.860 --> 00:04:32.880
I'm not going to enable it

117
00:04:32.880 --> 00:04:34.680
but we can still go ahead with the setup.

118
00:04:34.680 --> 00:04:36.510
So then we can configure a schedule.

119
00:04:36.510 --> 00:04:38.910
So how often do you want this policy to happen?

120
00:04:38.910 --> 00:04:41.280
And currently we can create up to four schedules.

121
00:04:41.280 --> 00:04:43.770
So this one and then another three.

122
00:04:43.770 --> 00:04:45.180
But we'll just have one schedule.

123
00:04:45.180 --> 00:04:47.910
And we'll say, okay, Daily,

124
00:04:47.910 --> 00:04:52.910
every 12 hours starting at 9:00 AM then do a snapshot.

125
00:04:53.490 --> 00:04:55.890
And I want you to keep 10 snapshots.

126
00:04:55.890 --> 00:04:56.790
So the idea is that saying,

127
00:04:56.790 --> 00:04:58.650
okay, we're going to snapshot, snapshot, snapshot,

128
00:04:58.650 --> 00:05:01.950
but by the way only keep 10 snapshots at a time.

129
00:05:01.950 --> 00:05:03.930
And then you can have some additional

130
00:05:03.930 --> 00:05:05.760
advanced settings, okay?

131
00:05:05.760 --> 00:05:08.520
So we can have some tagging on these.

132
00:05:08.520 --> 00:05:11.190
We can actually enable fast snapshot restore

133
00:05:11.190 --> 00:05:12.570
for the snapshots created by the schedule.

134
00:05:12.570 --> 00:05:13.800
But this is really not recommended.

135
00:05:13.800 --> 00:05:15.780
It's going to be very expensive.

136
00:05:15.780 --> 00:05:17.520
We can have cross region copy.

137
00:05:17.520 --> 00:05:20.610
So we can copy the snapshots up to three additional regions.

138
00:05:20.610 --> 00:05:22.860
And this is really good for disaster recovery.

139
00:05:22.860 --> 00:05:25.380
And you have your own settings for these snapshots as well.

140
00:05:25.380 --> 00:05:26.610
As well as cross account sharing

141
00:05:26.610 --> 00:05:28.260
whether or not you want to share

142
00:05:28.260 --> 00:05:30.030
these snapshots with other accounts.

143
00:05:30.030 --> 00:05:31.920
So it's a very comprehensive way

144
00:05:31.920 --> 00:05:36.060
of managing your backup policy for EBS volumes.

145
00:05:36.060 --> 00:05:37.920
And then it's created.

146
00:05:37.920 --> 00:05:40.802
And then it's gonna be if enabled is going to snapshot

147
00:05:40.802 --> 00:05:43.860
to snapshot your volumes regularly.

148
00:05:43.860 --> 00:05:45.300
So it's a quite a powerful feature

149
00:05:45.300 --> 00:05:46.680
and well you should know.

150
00:05:46.680 --> 00:05:50.220
And the last feature I want to show you is the recycle bin.

151
00:05:50.220 --> 00:05:53.760
So before when you took a snapshot and you deleted it,

152
00:05:53.760 --> 00:05:55.770
then it was gone forever, right?

153
00:05:55.770 --> 00:05:59.340
But what you can do is actually put it in the recycle bin.

154
00:05:59.340 --> 00:06:03.870
So this prevents against additional accidental deletes.

155
00:06:03.870 --> 00:06:04.703
And so for this,

156
00:06:04.703 --> 00:06:07.080
we need to create what's called a retention rule.

157
00:06:07.080 --> 00:06:08.670
And I created a demo retention rule

158
00:06:08.670 --> 00:06:09.870
but we can create another one.

159
00:06:09.870 --> 00:06:11.937
So Demo2RetentionRule,

160
00:06:15.060 --> 00:06:18.840
and then we apply this rule to specific resource types.

161
00:06:18.840 --> 00:06:21.780
So we have EBS snapshots or Amazon Machine Image.

162
00:06:21.780 --> 00:06:23.580
So I'll apply to EBS snapshots

163
00:06:23.580 --> 00:06:26.010
and I will apply to all resources.

164
00:06:26.010 --> 00:06:28.650
Or if I uncheck this, I can use resource tags

165
00:06:28.650 --> 00:06:30.660
to find specific snapshots.

166
00:06:30.660 --> 00:06:32.070
So I'll apply to all resources

167
00:06:32.070 --> 00:06:34.680
and then we specify the retention period,

168
00:06:34.680 --> 00:06:37.320
so from one day up to one year.

169
00:06:37.320 --> 00:06:39.060
So we can do for example, seven days.

170
00:06:39.060 --> 00:06:40.230
That's perfect.

171
00:06:40.230 --> 00:06:42.120
And then the rule lock setting.

172
00:06:42.120 --> 00:06:45.570
So this is a setting which allows you to prevent

173
00:06:45.570 --> 00:06:48.120
this specific rule from being deleted

174
00:06:48.120 --> 00:06:51.150
in case you don't want to be attacked or have accidents.

175
00:06:51.150 --> 00:06:53.370
So you can unlock it, which that means that this rule

176
00:06:53.370 --> 00:06:56.070
can be modified at any point by anyone

177
00:06:56.070 --> 00:06:58.770
or you can lock it and say that this rule will be locked

178
00:06:58.770 --> 00:07:02.100
for a specific delay period and no one can change it.

179
00:07:02.100 --> 00:07:04.740
And this is a lock that allows you to get more safety

180
00:07:04.740 --> 00:07:05.640
around this rule.

181
00:07:05.640 --> 00:07:07.020
So we'll leave this unlocked

182
00:07:07.020 --> 00:07:09.630
and then we'll click on Create retention rule.

183
00:07:09.630 --> 00:07:11.700
So we just create this retention rule

184
00:07:11.700 --> 00:07:15.060
and now we have, as you'll see, two retention rules

185
00:07:15.060 --> 00:07:17.430
because it's the second one I create, okay?

186
00:07:17.430 --> 00:07:18.480
And then what's going to happen

187
00:07:18.480 --> 00:07:20.700
is that if you do delete a snapshot,

188
00:07:20.700 --> 00:07:22.770
so let me delete this retention right here

189
00:07:22.770 --> 00:07:24.390
because we don't actually need it.

190
00:07:24.390 --> 00:07:25.640
I already have one, okay?

191
00:07:26.850 --> 00:07:28.770
But if we do delete a snapshot,

192
00:07:28.770 --> 00:07:30.600
so let's go ahead and take for example,

193
00:07:30.600 --> 00:07:33.363
take this one and delete it.

194
00:07:35.460 --> 00:07:36.660
It's gone.

195
00:07:36.660 --> 00:07:38.670
We can go into the Resources.

196
00:07:38.670 --> 00:07:41.880
And as you can see, well one of these snapshots, okay,

197
00:07:41.880 --> 00:07:46.880
was put into the recycle bin thanks to my recycle bin rule.

198
00:07:47.160 --> 00:07:49.920
And so that means that it entered right now

199
00:07:49.920 --> 00:07:51.450
and it's going to leave in one day,

200
00:07:51.450 --> 00:07:54.540
because this is what my other rule was set up to do.

201
00:07:54.540 --> 00:07:56.070
And what I can do from this

202
00:07:56.070 --> 00:07:58.247
is actually recover my snapshots.

203
00:07:58.247 --> 00:08:01.650
And so as you can see right here, it doesn't exist, right?

204
00:08:01.650 --> 00:08:03.093
But then I recover it,

205
00:08:04.200 --> 00:08:07.080
and all of a sudden the snapshot has reappeared

206
00:08:07.080 --> 00:08:09.210
thanks to the recycle bin recovering.

207
00:08:09.210 --> 00:08:11.520
Okay, so I think that's all the features you need to know

208
00:08:11.520 --> 00:08:12.990
for EBS snapshots quite a lot,

209
00:08:12.990 --> 00:08:16.380
but it's quite good to know them as a SysOps.

210
00:08:16.380 --> 00:08:19.380
I hope you liked it, and I will see you in the next lecture.

