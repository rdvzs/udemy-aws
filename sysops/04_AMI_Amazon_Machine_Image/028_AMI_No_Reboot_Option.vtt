WEBVTT

1
00:00:00.300 --> 00:00:02.620
<v ->So now let's have a look at one specific option when</v>

2
00:00:02.620 --> 00:00:05.490
creating AMI, which is a No-Reboot option.

3
00:00:05.490 --> 00:00:08.720
So it allows you to create an AMI without first

4
00:00:08.720 --> 00:00:11.200
shutting down your EC2 instance.

5
00:00:11.200 --> 00:00:12.600
And by default it's not selected,

6
00:00:12.600 --> 00:00:14.820
that means that any time we want to create an AMI

7
00:00:14.820 --> 00:00:17.580
we want to shut down the instance before creating the AMI

8
00:00:17.580 --> 00:00:20.500
and this is to maintain the file system integrity.

9
00:00:20.500 --> 00:00:21.460
So this is what happens.

10
00:00:21.460 --> 00:00:22.580
So with the No-Reboot disabled,

11
00:00:22.580 --> 00:00:24.980
if we want to initiate creating an AMI,

12
00:00:24.980 --> 00:00:27.070
the instance is first shut shutdown.

13
00:00:27.070 --> 00:00:28.240
Then after shutdown,

14
00:00:28.240 --> 00:00:30.340
the attached EBS volume will get

15
00:00:30.340 --> 00:00:33.350
a snapshot taken into an EBS snapshot.

16
00:00:33.350 --> 00:00:37.300
And then the EBS snapshot will be converted into an AMI.

17
00:00:37.300 --> 00:00:40.290
Now if you enable the No-Reboot option,

18
00:00:40.290 --> 00:00:42.840
then your EC2 instance that is currently running,

19
00:00:42.840 --> 00:00:44.770
will get a snapshot directly made

20
00:00:44.770 --> 00:00:47.630
onto its running attached EBS volume

21
00:00:47.630 --> 00:00:49.550
and then the image will be created.

22
00:00:49.550 --> 00:00:53.590
So the risk here is to not have a file system integrity.

23
00:00:53.590 --> 00:00:57.390
Also, any OS operating system buffer will not be flushed to

24
00:00:57.390 --> 00:00:59.560
the disc before the snapshot is created.

25
00:00:59.560 --> 00:01:01.240
So you need to make sure that you know what you're doing

26
00:01:01.240 --> 00:01:02.580
when you're creating an AMI

27
00:01:02.580 --> 00:01:04.850
while the instance is still running.

28
00:01:04.850 --> 00:01:05.683
Now, why do I say this?

29
00:01:05.683 --> 00:01:08.550
Well, because when you use the backup service in AWS,

30
00:01:08.550 --> 00:01:09.690
you can create a backup plan

31
00:01:09.690 --> 00:01:11.690
and this allows you to create an AMI.

32
00:01:11.690 --> 00:01:14.260
Now, the backup service does not reboot the instances while

33
00:01:14.260 --> 00:01:15.180
taking EBS snapshot,

34
00:01:15.180 --> 00:01:18.020
so by default, the only option actually

35
00:01:18.020 --> 00:01:20.140
is to have the no-reboot behavior.

36
00:01:20.140 --> 00:01:23.160
That means that when you use AWS backup on Amazon EC2,

37
00:01:23.160 --> 00:01:25.890
the AMIs will be created using the parameter

38
00:01:25.890 --> 00:01:29.330
no-reboots that the instances are not being interrupted

39
00:01:29.330 --> 00:01:30.540
while they're functioning.

40
00:01:30.540 --> 00:01:32.480
So that means that when you use the backup plans,

41
00:01:32.480 --> 00:01:35.870
this will not help you guarantee that the file system will

42
00:01:35.870 --> 00:01:37.330
have its integrity, okay?

43
00:01:37.330 --> 00:01:38.810
Because you will need to reboot the instance first.

44
00:01:38.810 --> 00:01:40.010
And so, as an alternative,

45
00:01:40.010 --> 00:01:43.540
if you wanted to have a scheduled backup of your Amazon

46
00:01:43.540 --> 00:01:45.660
EC2 instance into an AMI,

47
00:01:45.660 --> 00:01:47.470
you could create an EventBridge rule.

48
00:01:47.470 --> 00:01:49.420
So for example, you could create a schedule

49
00:01:49.420 --> 00:01:51.710
which will invoke the Lambda function once every week.

50
00:01:51.710 --> 00:01:55.480
The Lambda function will have its own code to create an AMI,

51
00:01:55.480 --> 00:01:56.660
okay, create an image,

52
00:01:56.660 --> 00:01:59.670
with this time with the reboot option.

53
00:01:59.670 --> 00:02:01.460
In this case, then the Amazon EC2

54
00:02:01.460 --> 00:02:04.633
will be rebooting and an AMI will be created.

55
00:02:05.500 --> 00:02:07.710
So if you have a running instance and you want to see

56
00:02:07.710 --> 00:02:10.570
the option, very simple, right click

57
00:02:10.570 --> 00:02:13.710
and then you do Image and templates, Create Image.

58
00:02:13.710 --> 00:02:16.250
So just like before and in here,

59
00:02:16.250 --> 00:02:17.940
you have no reboot enabled.

60
00:02:17.940 --> 00:02:20.630
And this allows you for your instance to have it snapshot

61
00:02:20.630 --> 00:02:22.890
taken without an AMI being created

62
00:02:22.890 --> 00:02:25.090
without it rebooting first.

63
00:02:25.090 --> 00:02:26.780
So you need to use it at your own risk.

64
00:02:26.780 --> 00:02:28.360
And this is the option that is used by default

65
00:02:28.360 --> 00:02:29.740
when using the backup service.

66
00:02:29.740 --> 00:02:32.550
That's all I wanted to show you in this lecture.

67
00:02:32.550 --> 00:02:34.920
So I can just go ahead and cancel my window.

68
00:02:34.920 --> 00:02:35.753
So that's it.

69
00:02:35.753 --> 00:02:36.586
I hope you liked it

70
00:02:36.586 --> 00:02:38.070
and I will see you in the next lecture.

