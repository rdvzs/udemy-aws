WEBVTT

1
00:00:00.000 --> 00:00:00.990
<v Instructor>So, let's have a look</v>

2
00:00:00.990 --> 00:00:03.150
at Content Filtering in EventBridge.

3
00:00:03.150 --> 00:00:05.790
So it's good to open this documentation page,

4
00:00:05.790 --> 00:00:08.310
just Google it, and then you will have access

5
00:00:08.310 --> 00:00:11.100
to how we can filter events in EventBridge.

6
00:00:11.100 --> 00:00:13.800
And filtering events can be very helpful in EventBridge

7
00:00:13.800 --> 00:00:15.810
because you may want to only react

8
00:00:15.810 --> 00:00:17.190
to specific kind of events

9
00:00:17.190 --> 00:00:21.180
and not everything that is provided within a specific rule.

10
00:00:21.180 --> 00:00:24.630
So the kind of filter we can do is Prefix matching

11
00:00:24.630 --> 00:00:26.130
and Suffix matching.

12
00:00:26.130 --> 00:00:28.830
Anything but matching we can do Numeric matching.

13
00:00:28.830 --> 00:00:31.410
IP address matching, Exist matching,

14
00:00:31.410 --> 00:00:33.270
and then Equals-ignore-case matching,

15
00:00:33.270 --> 00:00:35.460
and then some complex examples.

16
00:00:35.460 --> 00:00:37.770
So let's go through an exercise

17
00:00:37.770 --> 00:00:38.730
of understanding how it works.

18
00:00:38.730 --> 00:00:42.083
So let's create a rule, I'll call this DemoS3Matching.

19
00:00:44.520 --> 00:00:47.100
And we want to have a look at this rule,

20
00:00:47.100 --> 00:00:50.250
and this rule is going to be for AWS events.

21
00:00:50.250 --> 00:00:54.060
And the event type is going to be S3 Object Created.

22
00:00:54.060 --> 00:00:55.410
So this is the kind event we have,

23
00:00:55.410 --> 00:00:57.660
it's a pretty complex event.

24
00:00:57.660 --> 00:01:00.120
It has, the detail type is Object Created,

25
00:01:00.120 --> 00:01:03.990
the source is AWS S3, we have the account number,

26
00:01:03.990 --> 00:01:07.680
we have the time, the region, the resources,

27
00:01:07.680 --> 00:01:08.820
the detail, and so on.

28
00:01:08.820 --> 00:01:11.430
So the name of the bucket, the key, and so on.

29
00:01:11.430 --> 00:01:13.710
So, it gets, you know, and the source IP address.

30
00:01:13.710 --> 00:01:15.360
So quite a lot of things to be honest.

31
00:01:15.360 --> 00:01:16.980
So let's have a look at what we can do.

32
00:01:16.980 --> 00:01:20.460
So, we can have a Creation method of Use pattern form,

33
00:01:20.460 --> 00:01:23.040
and again, we have to respecify S3.

34
00:01:23.040 --> 00:01:24.780
So let's specify S3.

35
00:01:24.780 --> 00:01:29.418
And the event type is, again, Object-Level API,

36
00:01:29.418 --> 00:01:30.990
no All Events.

37
00:01:30.990 --> 00:01:32.670
And we can start to filter right here.

38
00:01:32.670 --> 00:01:35.730
So, let's say we want to match this specific event,

39
00:01:35.730 --> 00:01:37.920
Object Created, but as you can see,

40
00:01:37.920 --> 00:01:39.930
it was not in the dropdown here.

41
00:01:39.930 --> 00:01:43.380
So what we can do is modify the events pattern.

42
00:01:43.380 --> 00:01:45.300
And this event pattern we'll modify,

43
00:01:45.300 --> 00:01:48.390
will help us actually build matching

44
00:01:48.390 --> 00:01:50.400
for these kind of events.

45
00:01:50.400 --> 00:01:54.180
So let's go into Edit pattern.

46
00:01:54.180 --> 00:01:57.090
And here we can edit the pattern in JSON form.

47
00:01:57.090 --> 00:02:00.300
So we want the source to be AWS S3

48
00:02:00.300 --> 00:02:03.960
and we want the type of object to be Object Created.

49
00:02:03.960 --> 00:02:08.670
So here, I'm going to include detail type, Object Created.

50
00:02:08.670 --> 00:02:11.280
And this ensures from my event pattern

51
00:02:11.280 --> 00:02:13.860
that I have an exact match on the source being S3

52
00:02:13.860 --> 00:02:17.400
and the detail type being Object Created, okay?

53
00:02:17.400 --> 00:02:19.530
So this is super important

54
00:02:19.530 --> 00:02:21.450
because well, this is exact matching,

55
00:02:21.450 --> 00:02:24.180
but you can do more than that for filtering.

56
00:02:24.180 --> 00:02:27.990
Let's say for example, we wanted to have a specific bucket.

57
00:02:27.990 --> 00:02:31.470
Well to do so, you would look at the detail,

58
00:02:31.470 --> 00:02:32.910
and on the detail there's bucket,

59
00:02:32.910 --> 00:02:34.050
and under bucket there is names.

60
00:02:34.050 --> 00:02:39.050
So, let's copy all of this and paste it.

61
00:02:39.570 --> 00:02:41.970
And I'm going to just have the proper syntax.

62
00:02:41.970 --> 00:02:43.620
Here we go.

63
00:02:43.620 --> 00:02:47.070
And now we can see that we can match on detail.

64
00:02:47.070 --> 00:02:51.360
Bucket name being mybucket.

65
00:02:51.360 --> 00:02:52.800
And this works great.

66
00:02:52.800 --> 00:02:53.910
But let's say for example,

67
00:02:53.910 --> 00:02:57.630
you wanted to match for a prefix of buckets,

68
00:02:57.630 --> 00:02:58.560
not just my bucket,

69
00:02:58.560 --> 00:03:01.020
but anything that starts with mybuckets.

70
00:03:01.020 --> 00:03:03.630
What you can do is that you enter a new line,

71
00:03:03.630 --> 00:03:05.943
you have prefix matching and you insert.

72
00:03:07.470 --> 00:03:10.770
And, in here it says the way to do it,

73
00:03:10.770 --> 00:03:12.270
so you have the same documentation

74
00:03:12.270 --> 00:03:13.920
and you have an example right here.

75
00:03:13.920 --> 00:03:18.920
So you replace String by name and prefix being mybuckets.

76
00:03:20.520 --> 00:03:23.790
So now, we have a condition, it's a little bit more complex,

77
00:03:23.790 --> 00:03:24.870
but now the condition is saying,

78
00:03:24.870 --> 00:03:27.120
Hey I want you to match the buckets,

79
00:03:27.120 --> 00:03:29.820
whose name has the prefixed, mybuckets.

80
00:03:29.820 --> 00:03:30.840
And this is very helpful

81
00:03:30.840 --> 00:03:33.510
because now we match many more events.

82
00:03:33.510 --> 00:03:34.980
You can have suffix matching.

83
00:03:34.980 --> 00:03:37.200
So for example, you can look at the file name

84
00:03:37.200 --> 00:03:38.970
and you want it to end with .png

85
00:03:38.970 --> 00:03:42.570
because we only want the .png files in this event.

86
00:03:42.570 --> 00:03:44.220
So where is the object key?

87
00:03:44.220 --> 00:03:45.420
Well the object key is right here,

88
00:03:45.420 --> 00:03:49.140
so we have detailed object and key.

89
00:03:49.140 --> 00:03:50.626
So I'm going to copy this.

90
00:03:50.626 --> 00:03:53.910
I'm actually going to write it, it's gonna be easier, so.

91
00:03:53.910 --> 00:03:58.910
Object. Okay, and we enter a new right here.

92
00:03:59.550 --> 00:04:03.780
We have to add a comma right here. Okay.

93
00:04:03.780 --> 00:04:08.780
And then the key we're looking for is key, I believe.

94
00:04:08.970 --> 00:04:12.690
Yeah it is. And then we want it to be a suffix.

95
00:04:12.690 --> 00:04:13.957
So we'll have it like this.

96
00:04:13.957 --> 00:04:18.660
Paste this in and boom. We have suffix .png.

97
00:04:18.660 --> 00:04:20.580
So now we'll match all the buckets

98
00:04:20.580 --> 00:04:21.510
that start with mybuckets

99
00:04:21.510 --> 00:04:24.870
and all the keys that start with, that end with .png.

100
00:04:24.870 --> 00:04:26.400
And all the things you find on commission,

101
00:04:26.400 --> 00:04:28.500
you can also find right here.

102
00:04:28.500 --> 00:04:30.690
So, you can have anything, but,

103
00:04:30.690 --> 00:04:34.710
so you match all the values but initializing, for example.

104
00:04:34.710 --> 00:04:36.510
You can have numeric matching.

105
00:04:36.510 --> 00:04:38.100
So you can have a look at numeric values

106
00:04:38.100 --> 00:04:41.490
and say, are they greater than zero or less than five,

107
00:04:41.490 --> 00:04:42.323
and so on.

108
00:04:42.323 --> 00:04:44.580
And again, all these kind of things

109
00:04:44.580 --> 00:04:46.680
can be just inserted right here,

110
00:04:46.680 --> 00:04:49.620
and you can construct it as well as you want.

111
00:04:49.620 --> 00:04:52.800
Okay. And then you have IP address matching.

112
00:04:52.800 --> 00:04:56.010
So we have an IP address in here, source IP address.

113
00:04:56.010 --> 00:04:58.380
So we could definitely match on it.

114
00:04:58.380 --> 00:05:01.800
And we can say detail sourceIPaddress equals this,

115
00:05:01.800 --> 00:05:04.260
and we just need to make sure we name it correctly,

116
00:05:04.260 --> 00:05:09.260
so detail, and then we name this sourceIPaddress correctly.

117
00:05:10.320 --> 00:05:13.710
So sourceIPaddress like this.

118
00:05:13.710 --> 00:05:15.240
And we have a cidr.

119
00:05:15.240 --> 00:05:17.730
We have exist to make sure that a specific key exists

120
00:05:17.730 --> 00:05:20.670
in case our application is expecting, for example,

121
00:05:20.670 --> 00:05:22.620
size to be always there, then we need to,

122
00:05:22.620 --> 00:05:24.600
we can make sure that size is always here

123
00:05:24.600 --> 00:05:27.990
using the exist type of matching and so on.

124
00:05:27.990 --> 00:05:29.940
And the reason I'm showing you this is that

125
00:05:29.940 --> 00:05:31.230
it's important for you to understand

126
00:05:31.230 --> 00:05:32.670
how to construct an event pattern,

127
00:05:32.670 --> 00:05:35.130
not just use the basic ones that EventBridge gives you.

128
00:05:35.130 --> 00:05:36.360
But to know that you have

129
00:05:36.360 --> 00:05:40.080
a very advanced filtering capabilities included in this.

130
00:05:40.080 --> 00:05:42.030
And then of course, thanks to this event pattern,

131
00:05:42.030 --> 00:05:44.310
only events matching these conditions

132
00:05:44.310 --> 00:05:47.160
will be matched and sent to my targets.

133
00:05:47.160 --> 00:05:48.540
Alright, that's it for this lecture.

134
00:05:48.540 --> 00:05:49.770
I hope you liked it.

135
00:05:49.770 --> 00:05:51.720
And I will see you in the next lecture.

